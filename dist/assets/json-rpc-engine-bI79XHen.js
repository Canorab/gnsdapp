import{c as h}from"./@babel-BTUyE5mg.js";import{e as R}from"./events-BEk73iUA.js";import{d as A}from"./eth-rpc-errors-C5LhrPve.js";var O={},_={},p={};Object.defineProperty(p,"__esModule",{value:!0});p.getUniqueId=void 0;const P=4294967295;let M=Math.floor(Math.random()*P);function $(){return M=(M+1)%P,M}p.getUniqueId=$;Object.defineProperty(_,"__esModule",{value:!0});_.createIdRemapMiddleware=void 0;const C=p;function b(){return(a,e,r,t)=>{const o=a.id,n=C.getUniqueId();a.id=n,e.id=n,r(i=>{a.id=o,e.id=o,i()})}}_.createIdRemapMiddleware=b;var m={};Object.defineProperty(m,"__esModule",{value:!0});m.createAsyncMiddleware=void 0;function I(a){return async(e,r,t,o)=>{let n;const i=new Promise(f=>{n=f});let d=null,s=!1;const c=async()=>{s=!0,t(f=>{d=f,n()}),await i};try{await a(e,r,c),s?(await i,d(null)):o(null)}catch(f){d?d(f):o(f)}}}m.createAsyncMiddleware=I;var y={};Object.defineProperty(y,"__esModule",{value:!0});y.createScaffoldMiddleware=void 0;function H(a){return(e,r,t,o)=>{const n=a[e.method];return n===void 0?t():typeof n=="function"?n(e,r,t,o):(r.result=n,o())}}y.createScaffoldMiddleware=H;var w={},g={};Object.defineProperty(g,"__esModule",{value:!0});const S=R;function j(a,e,r){try{Reflect.apply(a,e,r)}catch(t){setTimeout(()=>{throw t})}}function U(a){const e=a.length,r=new Array(e);for(let t=0;t<e;t+=1)r[t]=a[t];return r}class x extends S.EventEmitter{emit(e,...r){let t=e==="error";const o=this._events;if(o!==void 0)t=t&&o.error===void 0;else if(!t)return!1;if(t){let i;if(r.length>0&&([i]=r),i instanceof Error)throw i;const d=new Error(`Unhandled error.${i?` (${i.message})`:""}`);throw d.context=i,d}const n=o[e];if(n===void 0)return!1;if(typeof n=="function")j(n,this,r);else{const i=n.length,d=U(n);for(let s=0;s<i;s+=1)j(d[s],this,r)}return!0}}g.default=x;var B=h&&h.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(w,"__esModule",{value:!0});w.JsonRpcEngine=void 0;const N=B(g),u=A;class l extends N.default{constructor(){super(),this._middleware=[]}push(e){this._middleware.push(e)}handle(e,r){if(r&&typeof r!="function")throw new Error('"callback" must be a function if provided.');return Array.isArray(e)?r?this._handleBatch(e,r):this._handleBatch(e):r?this._handle(e,r):this._promiseHandle(e)}asMiddleware(){return async(e,r,t,o)=>{try{const[n,i,d]=await l._runAllMiddleware(e,r,this._middleware);return i?(await l._runReturnHandlers(d),o(n)):t(async s=>{try{await l._runReturnHandlers(d)}catch(c){return s(c)}return s()})}catch(n){return o(n)}}}async _handleBatch(e,r){try{const t=await Promise.all(e.map(this._promiseHandle.bind(this)));return r?r(null,t):t}catch(t){if(r)return r(t);throw t}}_promiseHandle(e){return new Promise(r=>{this._handle(e,(t,o)=>{r(o)})})}async _handle(e,r){if(!e||Array.isArray(e)||typeof e!="object"){const i=new u.EthereumRpcError(u.errorCodes.rpc.invalidRequest,`Requests must be plain objects. Received: ${typeof e}`,{request:e});return r(i,{id:void 0,jsonrpc:"2.0",error:i})}if(typeof e.method!="string"){const i=new u.EthereumRpcError(u.errorCodes.rpc.invalidRequest,`Must specify a string method. Received: ${typeof e.method}`,{request:e});return r(i,{id:e.id,jsonrpc:"2.0",error:i})}const t=Object.assign({},e),o={id:t.id,jsonrpc:t.jsonrpc};let n=null;try{await this._processRequest(t,o)}catch(i){n=i}return n&&(delete o.result,o.error||(o.error=u.serializeError(n))),r(n,o)}async _processRequest(e,r){const[t,o,n]=await l._runAllMiddleware(e,r,this._middleware);if(l._checkForCompletion(e,r,o),await l._runReturnHandlers(n),t)throw t}static async _runAllMiddleware(e,r,t){const o=[];let n=null,i=!1;for(const d of t)if([n,i]=await l._runMiddleware(e,r,d,o),i)break;return[n,i,o.reverse()]}static _runMiddleware(e,r,t,o){return new Promise(n=>{const i=s=>{const c=s||r.error;c&&(r.error=u.serializeError(c)),n([c,!0])},d=s=>{r.error?i(r.error):(s&&(typeof s!="function"&&i(new u.EthereumRpcError(u.errorCodes.rpc.internal,`JsonRpcEngine: "next" return handlers must be functions. Received "${typeof s}" for request:
${E(e)}`,{request:e})),o.push(s)),n([null,!1]))};try{t(e,r,d,i)}catch(s){i(s)}})}static async _runReturnHandlers(e){for(const r of e)await new Promise((t,o)=>{r(n=>n?o(n):t())})}static _checkForCompletion(e,r,t){if(!("result"in r)&&!("error"in r))throw new u.EthereumRpcError(u.errorCodes.rpc.internal,`JsonRpcEngine: Response has no error or result for request:
${E(e)}`,{request:e});if(!t)throw new u.EthereumRpcError(u.errorCodes.rpc.internal,`JsonRpcEngine: Nothing ended request:
${E(e)}`,{request:e})}}w.JsonRpcEngine=l;function E(a){return JSON.stringify(a,null,2)}var v={};Object.defineProperty(v,"__esModule",{value:!0});v.mergeMiddleware=void 0;const J=w;function z(a){const e=new J.JsonRpcEngine;return a.forEach(r=>e.push(r)),e.asMiddleware()}v.mergeMiddleware=z;(function(a){var e=h&&h.__createBinding||(Object.create?function(t,o,n,i){i===void 0&&(i=n),Object.defineProperty(t,i,{enumerable:!0,get:function(){return o[n]}})}:function(t,o,n,i){i===void 0&&(i=n),t[i]=o[n]}),r=h&&h.__exportStar||function(t,o){for(var n in t)n!=="default"&&!Object.prototype.hasOwnProperty.call(o,n)&&e(o,t,n)};Object.defineProperty(a,"__esModule",{value:!0}),r(_,a),r(m,a),r(y,a),r(p,a),r(w,a),r(v,a)})(O);export{O as d};
